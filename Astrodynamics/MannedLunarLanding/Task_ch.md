# 2025 航天动力学作业——载人登月

## 1. 背景
1958 年，苏联与美国开启了月球探测。1969 年，美国实现了首次载人登月；到 1972 年，共有 12 名宇航员登陆月球。沉寂数十年后，进入 21 世纪，随着航天技术发展以及“可持续探索”理念兴起，重返月球、开发月球资源、建立长期月球基地已成为全球航天活动中的必然趋势与竞争热点。

中国自古便有“嫦娥奔月”的宏大愿景。2004 年，中国首个月球探测工程正式获批实施。迄今为止，探月工程“三步走”无人月球探测任务已圆满完成，探月工程正式进入载人登月阶段。2025 年 10 月 30 日，在神舟二十一号载人飞行任务新闻发布会上，中国载人航天工程新闻发言人、中国载人航天工程办公室综合计划局局长张景波表示：“我们坚定不移推进中国人 2030 年前实现登陆月球的目标。”

本航天动力学作业基于“载人登月”场景：在平面圆形限制性三体模型下设计地月转移轨道，将航天员送入月球轨道执行任务并返回，同时尽可能提高登月有效载荷能力。

## 2. 问题描述
为实现常态化载人登月运行，人类已在地月 L1 拉格朗日点附近的一条平面周期轨道上部署一艘**燃料补给航天器**，利用地月系统限制性三体动力学特性。该航天器可为载人航天器提供燃料补加或卸载服务。

### 2.1 任务主流程
1. **出发段**：搭载航天员的载人航天器从地球初始轨道出发，前往目标月球轨道。
2. **登月与任务段**：航天员登陆月面，开展科学任务并布设载荷；载人航天器停留在目标月球轨道；任务完成后，航天员返回载人航天器。
3. **返回段**：载人航天器搭载航天员从目标月球轨道出发返回地球。

### 2.2 流程细化与说明
* **A. 出发机动**：载人航天器可在初始轨道任意相位施加一次脉冲机动 Δv_dep 用于出发。该机动视为由运载火箭提供（见“质量计算”部分）；其后所有机动均为脉冲机动，且视为消耗航天器自身燃料。
* **B. 月球轨道约束**：载人航天器可在目标月球轨道任意相位到达，但必须满足“圆轨道”要求；任务完成后可从目标月球轨道任意相位离开。到达与离开时轨道平面方向（顺行/逆行）必须一致。
* **C. 补给会合（可选）**：在步骤（1）和（3）的地月或月地转移过程中，可设计载人航天器与燃料补给航天器会合以进行补加或卸载燃料。
    * **会合要求**：载人航天器与补给航天器的位置矢量和速度矢量必须相等。
    * **会合后状态**：对接后，补加或卸载时间不计入；在载人航天器执行分离机动前，其轨道状态视为与补给航天器一致。

## 3. 轨道定义
* **初始轨道**：相对地球高度 400 km 的圆轨道（顺行或逆行均可）。
* **目标轨道**：相对月球高度 100 km 的圆轨道（顺行或逆行均可）。
* **返回轨道**：近地点高度为 0 km 的轨道；航天器在近地点时视为返回地球。
* **补给轨道**：L1 平衡点附近的平面 Lyapunov 周期轨道，一种特殊三体轨道（具体参数见下文模型部分）。

> **注意**：地球初始圆轨道与月球目标圆轨道均是在“惯性系”下相对地球或月球的二体轨道。需区分“会合坐标系（旋转系）”与“惯性系”下的速度计算。

## 4. 质量计算
载人航天器总质量由三部分组成：
1. **航天器干质量（含航天员）**：10000 kg。
2. **燃料**：燃料箱最大可装 15000 kg，可部分加注。
3. **登月载荷**：扣除干质量与燃料后的剩余质量。所有登月载荷在登月任务后视为留在月面。

### 4.1 初始质量与发射能量
受运载火箭能力限制，航天器初始质量 M₀（kg）与发射能量 C₃（km²/s²）关系为：

M₀ = 25000 - 1000·C₃

其中发射能量 C₃ 计算为（从地球初始轨道出发时相对地球二体轨道能量的两倍）：

C₃ = v_dep² - 2μ_e/r_dep

### 4.2 燃料消耗计算
任务中施加的脉冲机动将折算为燃料消耗。设航天器施加速度增量 Δv（m/s），则机动后剩余质量 M_f 为：

M_f = M·exp(-Δv/3000)

其中 M 为机动前航天器质量。**每次机动的燃料消耗不得超过剩余燃料量。**

> **示例**：
> 假设航天器从地球初始轨道出发时 C₃=0，则初始总质量为 25000 kg。若仅携带 8000 kg 燃料，扣除 10000 kg 干质量后，剩余 7000 kg 即为登月载荷。
> 假设航天器到达目标月球轨道时剩余燃料 4000 kg，所有登月载荷留在月面。完成科学任务后，载人航天器总质量为干质量与燃料质量之和，即 14000 kg。

## 5. 平面圆形限制性三体模型

### 5.1 参数常数
* 地球引力参数：μ_e = 398600 km³/s²
* 月球引力参数：μ_m = 4903 km³/s²
* 地球半径：R_e = 6378 km
* 月球半径：R_m = 1737 km
* 地月距离（归一化单位）：[LU] = 384400 km

### 5.2 动力学微分方程
在地月“会合坐标系”中，方程为：

ẍ = 2ẏ + x - (1-μ)(x+μ)/r₁³ - μ(x-1+μ)/r₂³
ÿ = -2ẋ + y - (1-μ)y/r₁³ - μy/r₂³

其中：
r₁ = √((x+μ)² + y²)
r₂ = √((x-1+μ)² + y²)

### 5.3 补给航天器轨道计算
* **初始状态**：在初始时刻 t=0，补给航天器位置为 r_supply(0) = [0.8, 0]ᵀ。
* **求解要求**：需根据周期轨道要求求解该时刻补给航天器速度 v_supply(0) 与轨道周期 T。
* **状态传播**：在某时刻 t=t_i，补给航天器位置与速度矢量按如下方式计算（采用取模避免误差放大）：

    t̂_i = mod(t_i, T)
    r_supply(t_i) = r_supply(t̂_i)
    v_supply(t_i) = v_supply(t̂_i)

## 6. 约束条件

1. **总历时限制**：从载人航天器离开初始轨道到返回地球，全流程不得超过 **100 天**。
2. **月面停留时间**：航天员在月面科学任务时长为 **3.0 ~ 10.0 天**（即到达目标月球轨道与离开目标月球轨道之间的时间间隔）。
3. **空间范围限制**：所有转移轨道必须限制在半径 **2 倍地月距离**以内（考虑测控通信限制）。
4. **高度与安全限制**：
    * 相对月球轨道高度不得低于 100 km。
    * 进入返回轨道前，相对地球轨道高度不得低于 400 km。
    * **返回地球时剩余燃料不得超过 100 kg**。
5. **拼接点精度误差**：载人航天器在出发、会合、到达等拼接点的位置与速度允许误差：

    ||r_manned(t) - r_target(t)|| ≤ 10⁻⁶ [LU]
    ||v_manned(t) - v_target(t)|| ≤ 10⁻⁶ [VU]

    其中 [LU] 为地月距离，[VU] 为对应速度量纲。

## 7. 结果文件格式（results.txt）

为验证计算结果正确性，需提交结果文件，文件名与扩展名统一为 `results.txt`。

### 7.1 数据格式说明
除第一列（Event）为整数外，其余数据均采用**科学计数法**，并保留**12 位有效数字**。

| 列号 | 标题 | 单位 | 数据类型 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Event | - | int | 事件节点编码（见 7.2） |
| 2 | Time | TU | float | 归一化时间（初始为 0） |
| 3 | X | LU | float | 会合坐标系 X 位置分量 |
| 4 | Y | LU | float | 会合坐标系 Y 位置分量 |
| 5 | Vx | VU | float | 会合坐标系 X 速度分量 |
| 6 | Vy | VU | float | 会合坐标系 Y 速度分量 |
| 7 | ΔVx | VU | float | 速度增量 X 分量 |
| 8 | ΔVy | VU | float | 速度增量 Y 分量 |
| 9 | Mfuel | kg | float | 剩余燃料质量 |
| 10 | Mcarry | kg | float | 登月载荷质量 |

### 7.2 事件编码定义
* `-1`：航天器执行机动
* `0`：无机动轨道传播段
* `1`：从地球初始轨道出发
* `2`：到达目标月球轨道（同时视为开展月面科学任务）
* `3`：从目标月球轨道离开（同时视为科学任务结束）
* `4`：返回地球
* `5`：与补给航天器会合

### 7.3 记录规则补充
1. **无机动传播段（Event 0）**：至少需两行数据（首行为初始状态，次行为终止状态）。
2. **执行机动（Event -1）**：至少需两行数据。
    * 第一行：机动**前**状态，脉冲分量为 0。
    * 第二行：机动**后**状态，脉冲分量为设计值，且需计算剩余燃料质量。
3. **任务/停留（Event 2 & 3）**：Event 2 与 Event 3 应为连续两行，中间不得插入其他事件。
4. **补给（Event 5）**：若进行燃料补加或卸载，需两行数据（第一行为补加/卸载前状态；第二行为补加/卸载后状态）。
5. **结束（Event 4）**：文件**最后一行必须为 Event 4**。若缺失则视为不完整；若提前出现则视为任务提前结束。
