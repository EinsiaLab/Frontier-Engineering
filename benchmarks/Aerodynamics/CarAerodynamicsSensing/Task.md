# Car Aerodynamics Sensing (CarAerodynamicsSensing)

## Background
Aerodynamic pressure on a car surface varies with driving conditions. Because sensors are costly and limited, the goal is to place a small number of sensors on the surface that allow accurate reconstruction of the full pressure field.

## Task
Given a fixed 3D car surface point set, select **N = 30** sensor locations (point indices) to minimize the reconstruction error of the full surface pressure field on unseen test cases.

## Input
- `references/car_surface_points.npy`: a numpy array of shape `(M, 3)` that lists the surface points. Indices in your submission must refer to this array.
- The car aerodynamics dataset (external download; see `README.md`).

## Output
Create a `submission.json` file with the following schema:

```json
{
  "indices": [12, 480, 932,  ...  , 95427]
}
```

Constraints:
- Exactly 30 indices.
- Indices are **0-based** and **unique**.
- Each index must satisfy `0 <= index < M`.

## Data and Preprocessing
- Raw pressure files: `/data/physense_car_data/pressure_files/case_{i}_p_car_patch.raw`.
- Each line contains `x y z p` (coordinates and pressure).
- Sigma clipping (3 sigma) is applied to remove outliers.
- Pressure is normalized using:
  - `p_min = -844.3360`
  - `p_max =  602.6890`
  - `p_norm = (p - p_min) / (p_max - p_min)`
- The reference point set in `car_surface_points.npy` is generated by applying the same sigma clipping to `case_1`.

## Evaluation
- Test cases are `case_76` to `case_100` (25 cases total).
- Evaluation uses a fixed random seed (**2025**) to sample **K = 10** cases for scoring.
- For each test case:
  1. Load and preprocess the pressure field.
  2. Map submitted indices to reference points.
  3. Snap each reference point to the nearest available surface point for that case.
  4. Reconstruct the full pressure field using a pretrained Transolver base model.
  5. Compute Relative L2 Error:
     `rel_l2 = ||p_gt - p_pred||_2 / ||p_gt||_2`.
- Final score:
  - `score = 1.0 - mean(rel_l2)` across the K sampled cases.
  - Higher is better.

## Baseline
`baseline/solution.py` samples 30 random indices from the reference point set and writes `submission.json`.
