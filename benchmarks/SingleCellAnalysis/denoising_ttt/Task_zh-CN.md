# Open Problems in Single-Cell Analysis: Denoising Benchmark v1.0.0

## 🎯 任务背景

单细胞 RNA 测序（scRNA-Seq）技术虽然强大，但由于当前测序协议的限制，通常只能检测到每个细胞中存在的一小部分 mRNA 分子。这种极低的数据捕获率导致观测到的测量值（UMI 计数）伴随着极高的技术噪声（Technical Noise）。在数据矩阵中，这通常表现为大量的“零”值，即所谓的“Dropout（数据缺失）”或“技术零值”。这种高度稀疏和充满噪声的数据严重阻碍了下游的生物学分析（如细胞聚类、轨迹推断和差异表达分析）。

## 📝 任务描述

**去噪**任务的核心目标是：从充满噪声和缺失值的稀疏观测数据中，估计出每个基因在每个细胞中的**真实表达水平**。在单细胞文献中，这个任务有时也被称为“插补（Imputation）”。

**核心挑战**：评估去噪方法的最大障碍在于**缺乏真实参考标准**。因为我们无法在不破坏细胞的前提下，绝对准确地知道一个细胞内所有基因的真实 mRNA 数量。为了解决这个问题，现有的方法是一种名为**分子交叉验证（Molecular Cross-Validation, MCV）**的创新自监督评估框架。MCV 通过将观测到的分子随机划分为训练集和测试集，在理论和实践上证明了其量化的去噪准确率与拥有 Ground Truth 时的准确率高度一致。你的目标是在此基础上进行优化，或者创建一种新算法来提高准确率。

## 📥 输出与输出定义

* **输入**：稀疏的 scRNA-Seq 原始计数矩阵 $X \in \mathbb{N}^{C \times G}$，其中 $C$ 为细胞数量，$G$ 为基因数量。矩阵中的元素为观测到的 UMI 计数（包含大量技术噪声和 Dropout）。
* **输出**：去噪后的密集表达矩阵 $\hat{X} \in \mathbb{R}^{C \times G}$。矩阵中的元素代表算法估计的该细胞中该基因的真实表达水平或去噪后的相对丰度。

## 📊 评估指标

在 MCV 框架下，模型基于训练集生成的去噪矩阵，将直接与保留的测试集进行对比。本基准测试主要使用以下两个指标：

1. **均方误差** 衡量去噪后的预测值与测试集观测值之间的平均平方差。计算公式为：$$MSE = \frac{1}{N} \sum_{i=1}^{N} (y_i - \hat{y}_i)^2$$
其中 $y_i$ 是测试集中的观测计数，$\hat{y}_i$ 是模型的去噪预测值，$N$ 是矩阵中的元素总数。MSE 越低，表示预测值越接近观测分布。

2. **泊松损失** 由于 scRNA-Seq 的 UMI 计数在理论上通常服从泊松分布，泊松损失通过计算负对数似然来衡量模型的拟合优度。计算公式（单点简化版）为：$$L_{Poisson} = \hat{y}_i - y_i \log(\hat{y}_i)$$
该指标能更好地惩罚在低表达计数区域的预测偏差。分数越低，表示去噪效果越符合数据的统计特性。

## 🏆 现有方法的测试结果

本基准测试在 3 个不同的数据集（1k PBMC, Pancreas inDrop, Tabula Muris Senis Lung）上评估了 11 种主流去噪方法及其变体。

**资源与性能摘要表：**

| 方法  | 综合表现 | MSE 表现 | Poisson Loss 表现 | 峰值内存 | 运行时长 |
| --- | --- | --- | --- | --- | --- |
| **Perfect denoising** (对照上限) | 1.00 | 1.00 | 1.00 | 2G | 8m |
| **MAGIC** (及其变体) | **优** (~0.41-0.61) | **优** (~0.24) | **优** (~0.59-0.98) | ~465M - 490M | 9m - 18m |
| **ALRA** (及其变体) | 良 (~0.48) | 中 (-0.01) | **优** (~0.98) | ~465M | 44m - 47m |
| **DCA** (Deep Count Autoencoder) | 中 (~0.02) | 良 (~0.12) | 差 (-0.08) | ~960M | 13m |
| **KNN smoothing** | 较差 (0.00) | 中 (~0.08) | 差 (-0.08) | ~464M | 10m |
| **Iterative KNN smoothing** | 极差 (-5.10) | 中 (~0.09) | 极差 (-10.30) | ~485M | 44m |
| **No denoising** (对照下限) | 0.00 | 0.00 | 0.00 | 2G | 8m |

*(注：得分为归一化后的相对分数，1.0 代表理论最优，0.0 代表不做任何处理的基线，负数代表去噪后引入了比不处理更大的误差。)*